<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Modulo 5 - Windows Firewall</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: #0a0e17; color: #f1f5f9; font-family: 'Inter', sans-serif; }
    #root { min-height: 100vh; }
    @media (max-width: 768px) {
      .slide-content { padding: 16px !important; }
      .slide-content h1 { font-size: 28px !important; }
      .slide-content h2 { font-size: 20px !important; }
      .slide-content h3 { font-size: 16px !important; }
      pre { font-size: 10px !important; }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;
    const colors = { bg: '#0a0e17', bgCard: '#111827', bgLight: '#1e293b', accent: '#a78bfa', accentAlt: '#c4b5fd', text: '#f1f5f9', textDim: '#94a3b8', textMuted: '#64748b', border: '#334155', success: '#22c55e', danger: '#ef4444', warn: '#f59e0b', info: '#0ea5e9', purple: '#a78bfa', cyan: '#22d3ee' };

    const Code = ({ children, title }) => (<div style={{ background: '#0d1117', borderRadius: '8px', border: `1px solid ${colors.border}`, margin: '12px 0', overflow: 'hidden' }}>{title && <div style={{ background: '#161b22', padding: '8px 16px', borderBottom: `1px solid ${colors.border}`, fontFamily: 'monospace', fontSize: '11px', color: colors.textDim }}><span style={{color: colors.accent}}>‚óè</span> {title}</div>}<pre style={{ margin: 0, padding: '14px', fontFamily: 'JetBrains Mono, monospace', fontSize: '11px', lineHeight: '1.6', color: colors.text, overflowX: 'auto', whiteSpace: 'pre-wrap' }}>{children}</pre></div>);

    const Box = ({ type = 'info', title, children }) => { const cfg = { info: { c: colors.info, i: '‚ÑπÔ∏è' }, warn: { c: colors.warn, i: '‚ö†Ô∏è' }, danger: { c: colors.danger, i: 'üõë' }, tip: { c: colors.purple, i: 'üí°' }, success: { c: colors.success, i: '‚úì' } }; const { c, i } = cfg[type]; return (<div style={{ background: c + '15', border: `1px solid ${c}40`, borderLeft: `4px solid ${c}`, borderRadius: '0 8px 8px 0', padding: '14px 18px', margin: '14px 0' }}><div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '6px', fontWeight: '600', color: c }}>{i} {title}</div><div style={{ color: colors.textDim, lineHeight: '1.5', fontSize: '13px' }}>{children}</div></div>); };

    const Table = ({ headers, rows }) => (<div style={{ overflowX: 'auto', margin: '16px 0' }}><table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '12px' }}><thead><tr>{headers.map((h, i) => <th key={i} style={{ background: colors.bgLight, color: colors.accent, padding: '10px 12px', textAlign: 'left', borderBottom: `2px solid ${colors.accent}40` }}>{h}</th>)}</tr></thead><tbody>{rows.map((row, ri) => <tr key={ri}>{row.map((cell, ci) => <td key={ci} style={{ padding: '10px 12px', borderBottom: `1px solid ${colors.border}`, color: ci === 0 ? colors.text : colors.textDim, background: ri % 2 ? colors.bgLight + '40' : 'transparent' }}>{cell}</td>)}</tr>)}</tbody></table></div>);

    const Glow = ({ children, color = colors.accent }) => (<div style={{ position: 'relative', padding: '2px', borderRadius: '12px', background: `linear-gradient(135deg, ${color}40, transparent, ${color}20)` }}><div style={{ background: colors.bgCard, borderRadius: '10px', padding: '20px' }}>{children}</div></div>);

    const slides = [
      // Slide 1: Title
      () => (<div style={{ textAlign: 'center', padding: '60px 30px', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', minHeight: '70vh' }}><div style={{ fontSize: '48px', marginBottom: '20px' }}>ü™ü</div><div style={{ fontSize: '12px', color: colors.accent, textTransform: 'uppercase', letterSpacing: '3px', marginBottom: '16px' }}>Modulo 5</div><h1 style={{ fontSize: '42px', fontWeight: '700', background: `linear-gradient(135deg, ${colors.accent}, ${colors.accentAlt})`, WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent', marginBottom: '16px' }}>Windows Firewall</h1><p style={{ fontSize: '18px', color: colors.textDim, maxWidth: '500px', lineHeight: '1.6' }}>Windows Defender Firewall: profili, GUI, PowerShell e netsh</p></div>),

      // Slide 2: Introduzione
      () => (<div style={{ padding: '30px' }}><h2 style={{ color: colors.accent, marginBottom: '24px' }}>üõ°Ô∏è Windows Defender Firewall</h2><div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '24px' }}><Glow><h3 style={{ color: colors.accent, marginBottom: '12px' }}>Caratteristiche</h3><ul style={{ color: colors.textDim, lineHeight: '1.8', paddingLeft: '18px' }}><li><strong style={{ color: colors.text }}>Host-based firewall</strong> integrato in Windows</li><li><strong style={{ color: colors.text }}>Stateful inspection</strong></li><li>Supporto regole per <strong style={{ color: colors.text }}>applicazioni</strong></li><li>Integrazione con <strong style={{ color: colors.text }}>Windows Security Center</strong></li><li>Gestibile via GUI, PowerShell, GPO</li></ul></Glow><div><h3 style={{ color: colors.text, marginBottom: '12px' }}>üìÇ Strumenti di gestione</h3><div style={{ display: 'grid', gap: '10px' }}>{[['üñ•Ô∏è', 'Windows Security', 'Interfaccia semplificata'],['‚öôÔ∏è', 'wf.msc', 'Windows Firewall with Advanced Security'],['üíª', 'PowerShell', 'NetSecurity module'],['üìü', 'netsh', 'Legacy command line'],].map(([icon, name, desc]) => (<div key={name} style={{ display: 'flex', alignItems: 'center', gap: '12px', padding: '12px', background: colors.bgLight, borderRadius: '8px' }}><span style={{ fontSize: '20px' }}>{icon}</span><div><div style={{ color: colors.text, fontWeight: '500' }}>{name}</div><div style={{ color: colors.textMuted, fontSize: '12px' }}>{desc}</div></div></div>))}</div></div></div></div>),

      // Slide 3: Profili di rete
      () => (<div style={{ padding: '30px' }}><h2 style={{ color: colors.accent, marginBottom: '24px' }}>üåê Profili di Rete</h2><p style={{ color: colors.textDim, marginBottom: '20px' }}>Windows applica regole firewall diverse in base al tipo di rete rilevata:</p><div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(180px, 1fr))', gap: '20px' }}><div style={{ background: colors.bgCard, border: `2px solid ${colors.info}`, borderRadius: '12px', padding: '20px', textAlign: 'center' }}><div style={{ fontSize: '36px', marginBottom: '10px' }}>üè¢</div><div style={{ color: colors.info, fontWeight: 'bold', fontSize: '18px', marginBottom: '8px' }}>Domain</div><div style={{ color: colors.textDim, fontSize: '13px', lineHeight: '1.5' }}>PC connesso a un dominio Active Directory. Regole gestite centralmente via GPO. Pi√π permissivo.</div><div style={{ marginTop: '12px', padding: '6px 12px', background: colors.info + '20', borderRadius: '6px', color: colors.info, fontSize: '11px' }}>Rilevato automaticamente</div></div><div style={{ background: colors.bgCard, border: `2px solid ${colors.success}`, borderRadius: '12px', padding: '20px', textAlign: 'center' }}><div style={{ fontSize: '36px', marginBottom: '10px' }}>üè†</div><div style={{ color: colors.success, fontWeight: 'bold', fontSize: '18px', marginBottom: '8px' }}>Private</div><div style={{ color: colors.textDim, fontSize: '13px', lineHeight: '1.5' }}>Reti domestiche o aziendali fidate. Network discovery attivo. File sharing permesso.</div><div style={{ marginTop: '12px', padding: '6px 12px', background: colors.success + '20', borderRadius: '6px', color: colors.success, fontSize: '11px' }}>Selezionato dall'utente</div></div><div style={{ background: colors.bgCard, border: `2px solid ${colors.danger}`, borderRadius: '12px', padding: '20px', textAlign: 'center' }}><div style={{ fontSize: '36px', marginBottom: '10px' }}>‚òï</div><div style={{ color: colors.danger, fontWeight: 'bold', fontSize: '18px', marginBottom: '8px' }}>Public</div><div style={{ color: colors.textDim, fontSize: '13px', lineHeight: '1.5' }}>Reti pubbliche (WiFi bar, hotel). Massima protezione. Discovery disattivato.</div><div style={{ marginTop: '12px', padding: '6px 12px', background: colors.danger + '20', borderRadius: '6px', color: colors.danger, fontSize: '11px' }}>DEFAULT per nuove reti</div></div></div><Box type="warn" title="Best Practice">Tratta sempre le reti sconosciute come Public. Non fidarti mai del WiFi gratuito!</Box></div>),

      // Slide 4: GUI wf.msc
      () => (<div style={{ padding: '30px' }}><h2 style={{ color: colors.accent, marginBottom: '24px' }}>‚öôÔ∏è Windows Firewall Advanced Security</h2><p style={{ color: colors.textDim, marginBottom: '16px' }}>Apri con: <code style={{ background: colors.bgLight, padding: '4px 8px', borderRadius: '4px' }}>Win+R ‚Üí wf.msc</code></p><div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '24px' }}><div style={{ background: colors.bgCard, border: `1px solid ${colors.border}`, borderRadius: '12px', padding: '20px' }}><h3 style={{ color: colors.accent, marginBottom: '14px' }}>üì• Inbound Rules</h3><p style={{ color: colors.textDim, fontSize: '13px', marginBottom: '12px' }}>Controllano il traffico IN ENTRATA verso questo PC.</p><ul style={{ color: colors.textDim, fontSize: '13px', lineHeight: '1.7', paddingLeft: '16px' }}><li>Default: <strong style={{ color: colors.danger }}>Block</strong></li><li>Eccezioni per servizi Windows</li><li>Regole per applicazioni specifiche</li></ul></div><div style={{ background: colors.bgCard, border: `1px solid ${colors.border}`, borderRadius: '12px', padding: '20px' }}><h3 style={{ color: colors.purple, marginBottom: '14px' }}>üì§ Outbound Rules</h3><p style={{ color: colors.textDim, fontSize: '13px', marginBottom: '12px' }}>Controllano il traffico IN USCITA da questo PC.</p><ul style={{ color: colors.textDim, fontSize: '13px', lineHeight: '1.7', paddingLeft: '16px' }}><li>Default: <strong style={{ color: colors.success }}>Allow</strong></li><li>Utile per bloccare app specifiche</li><li>Controllo esfiltrazione dati</li></ul></div></div><Table headers={['Propriet√† Regola', 'Descrizione', 'Esempio']} rows={[['Program', 'Percorso eseguibile', 'C:\\Program Files\\App\\app.exe'],['Protocol/Port', 'TCP/UDP e porta', 'TCP 443'],['Scope', 'IP locali/remoti', '192.168.1.0/24'],['Action', 'Allow/Block/Secure', 'Allow'],['Profile', 'Domain/Private/Public', 'Private, Public'],]} /></div>),

      // Slide 5: PowerShell
      () => (<div style={{ padding: '30px' }}><h2 style={{ color: colors.accent, marginBottom: '24px' }}>üíª Gestione con PowerShell</h2><Code title="Comandi NetSecurity (PowerShell 5+)">{`# Visualizza stato firewall per tutti i profili
Get-NetFirewallProfile | Select Name, Enabled

# Abilita/Disabilita firewall
Set-NetFirewallProfile -Profile Domain,Private,Public -Enabled True

# Lista regole attive in ingresso
Get-NetFirewallRule -Direction Inbound -Enabled True |
    Select DisplayName, Action, Profile

# Crea regola: permetti HTTP in ingresso
New-NetFirewallRule -DisplayName "Allow HTTP" \`
    -Direction Inbound \`
    -Protocol TCP \`
    -LocalPort 80 \`
    -Action Allow \`
    -Profile Private,Domain

# Crea regola: permetti applicazione
New-NetFirewallRule -DisplayName "Allow MyApp" \`
    -Direction Inbound \`
    -Program "C:\\Apps\\myapp.exe" \`
    -Action Allow

# Blocca range IP
New-NetFirewallRule -DisplayName "Block BadNetwork" \`
    -Direction Inbound \`
    -RemoteAddress 10.10.10.0/24 \`
    -Action Block

# Rimuovi regola
Remove-NetFirewallRule -DisplayName "Allow HTTP"`}</Code></div>),

      // Slide 6: netsh e Confronto
      () => (<div style={{ padding: '30px' }}><h2 style={{ color: colors.accent, marginBottom: '24px' }}>üìü netsh (Legacy) e Confronto</h2><Code title="Comandi netsh advfirewall">{`# Stato firewall
netsh advfirewall show allprofiles

# Abilita firewall
netsh advfirewall set allprofiles state on

# Aggiungi regola porta
netsh advfirewall firewall add rule name="Allow HTTP" ^
    dir=in action=allow protocol=tcp localport=80

# Aggiungi regola programma
netsh advfirewall firewall add rule name="Allow App" ^
    dir=in action=allow program="C:\app.exe"

# Rimuovi regola
netsh advfirewall firewall delete rule name="Allow HTTP"

# Reset firewall (attenzione!)
netsh advfirewall reset`}</Code><Table headers={['Aspetto', 'Windows Firewall', 'iptables/nftables']} rows={[['Tipo', 'Host-based, GUI', 'Host o Perimetrale, CLI'],['Filtraggio App', '‚úì Per eseguibile', '‚úó Solo IP/Porta'],['Profili', 'Domain/Private/Public', 'No (chains)'],['Stateful', '‚úì Automatico', '‚úì Con -m state'],['Gestione', 'GUI + PS + GPO', 'Solo CLI/script'],]} /></div>),

      // Slide 7: Profile Switcher Simulator
      () => {
        const ProfileSwitcher = () => {
          const [profile, setProfile] = useState('Public');

          const rules = [
            { name: 'File and Printer Sharing', domain: true, private: true, public: false, icon: 'üìÅ' },
            { name: 'Network Discovery', domain: true, private: true, public: false, icon: 'üîç' },
            { name: 'Remote Desktop', domain: true, private: true, public: false, icon: 'üñ•Ô∏è' },
            { name: 'Windows Remote Management', domain: true, private: false, public: false, icon: '‚öôÔ∏è' },
            { name: 'Core Networking (ICMP)', domain: true, private: true, public: true, icon: 'üåê' },
            { name: 'DHCP Client', domain: true, private: true, public: true, icon: 'üì°' },
            { name: 'DNS Client', domain: true, private: true, public: true, icon: 'üî§' },
            { name: 'Windows Update', domain: true, private: true, public: true, icon: 'üîÑ' },
          ];

          const profileColors = { Domain: colors.info, Private: colors.success, Public: colors.danger };
          const profileIcons = { Domain: 'üè¢', Private: 'üè†', Public: '‚òï' };
          const profileDesc = {
            Domain: 'Connesso a un dominio Active Directory. Regole gestite centralmente.',
            Private: 'Rete domestica o aziendale fidata. Condivisione abilitata.',
            Public: 'WiFi pubblico (bar, hotel). Massima protezione attiva.'
          };

          const isAllowed = (rule) => {
            if (profile === 'Domain') return rule.domain;
            if (profile === 'Private') return rule.private;
            return rule.public;
          };

          return (
            <div style={{ display: 'grid', gap: '24px' }}>
              <div style={{ display: 'flex', gap: '16px', justifyContent: 'center', flexWrap: 'wrap' }}>
                {['Domain', 'Private', 'Public'].map(p => (
                  <button
                    key={p}
                    onClick={() => setProfile(p)}
                    style={{
                      padding: '16px 28px',
                      background: profile === p ? profileColors[p] + '30' : colors.bgCard,
                      border: `2px solid ${profile === p ? profileColors[p] : colors.border}`,
                      borderRadius: '12px',
                      cursor: 'pointer',
                      transition: 'all 0.3s',
                      minWidth: '140px'
                    }}
                  >
                    <div style={{ fontSize: '28px', marginBottom: '6px' }}>{profileIcons[p]}</div>
                    <div style={{ color: profileColors[p], fontWeight: 'bold' }}>{p}</div>
                  </button>
                ))}
              </div>

              <div style={{ background: profileColors[profile] + '15', border: `1px solid ${profileColors[profile]}40`, borderRadius: '12px', padding: '16px', textAlign: 'center' }}>
                <span style={{ fontSize: '20px', marginRight: '8px' }}>{profileIcons[profile]}</span>
                <span style={{ color: profileColors[profile], fontWeight: '600' }}>Profilo {profile} attivo</span>
                <p style={{ color: colors.textDim, fontSize: '13px', marginTop: '8px' }}>{profileDesc[profile]}</p>
              </div>

              <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(240px, 1fr))', gap: '12px' }}>
                {rules.map((rule, idx) => {
                  const allowed = isAllowed(rule);
                  return (
                    <div
                      key={idx}
                      style={{
                        display: 'flex',
                        alignItems: 'center',
                        gap: '12px',
                        padding: '14px',
                        background: allowed ? colors.success + '15' : colors.danger + '15',
                        border: `1px solid ${allowed ? colors.success : colors.danger}40`,
                        borderRadius: '10px',
                        transition: 'all 0.3s'
                      }}
                    >
                      <span style={{ fontSize: '22px' }}>{rule.icon}</span>
                      <div style={{ flex: 1 }}>
                        <div style={{ color: colors.text, fontSize: '13px', fontWeight: '500' }}>{rule.name}</div>
                        <div style={{ color: allowed ? colors.success : colors.danger, fontSize: '11px', marginTop: '2px' }}>
                          {allowed ? '‚úì Consentito' : '‚úó Bloccato'}
                        </div>
                      </div>
                      <div style={{ width: '10px', height: '10px', borderRadius: '50%', background: allowed ? colors.success : colors.danger }} />
                    </div>
                  );
                })}
              </div>

              <div style={{ background: colors.bgLight, borderRadius: '10px', padding: '14px', display: 'flex', justifyContent: 'space-around', flexWrap: 'wrap', gap: '12px' }}>
                <div style={{ textAlign: 'center' }}>
                  <div style={{ color: colors.success, fontSize: '24px', fontWeight: 'bold' }}>
                    {rules.filter(r => isAllowed(r)).length}
                  </div>
                  <div style={{ color: colors.textDim, fontSize: '12px' }}>Regole Attive</div>
                </div>
                <div style={{ textAlign: 'center' }}>
                  <div style={{ color: colors.danger, fontSize: '24px', fontWeight: 'bold' }}>
                    {rules.filter(r => !isAllowed(r)).length}
                  </div>
                  <div style={{ color: colors.textDim, fontSize: '12px' }}>Regole Bloccate</div>
                </div>
                <div style={{ textAlign: 'center' }}>
                  <div style={{ color: profileColors[profile], fontSize: '24px', fontWeight: 'bold' }}>
                    {profile === 'Public' ? 'ALTO' : profile === 'Private' ? 'MEDIO' : 'BASSO'}
                  </div>
                  <div style={{ color: colors.textDim, fontSize: '12px' }}>Livello Sicurezza</div>
                </div>
              </div>
            </div>
          );
        };

        return (
          <div style={{ padding: '30px' }}>
            <h2 style={{ color: colors.accent, marginBottom: '8px' }}>üîÄ Simulatore: Profile Switcher</h2>
            <p style={{ color: colors.textDim, marginBottom: '24px' }}>Seleziona un profilo per vedere quali regole firewall sono attive</p>
            <ProfileSwitcher />
          </div>
        );
      },

      // Slide 8: PowerShell Rule Builder
      () => {
        const PowerShellRuleBuilder = () => {
          const [ruleName, setRuleName] = useState('My Custom Rule');
          const [direction, setDirection] = useState('Inbound');
          const [action, setAction] = useState('Allow');
          const [protocol, setProtocol] = useState('TCP');
          const [port, setPort] = useState('443');
          const [profiles, setProfiles] = useState(['Private']);
          const [useProgram, setUseProgram] = useState(false);
          const [program, setProgram] = useState('C:\\Program Files\\App\\app.exe');
          const [remoteIP, setRemoteIP] = useState('');

          const toggleProfile = (p) => {
            if (profiles.includes(p)) {
              if (profiles.length > 1) setProfiles(profiles.filter(x => x !== p));
            } else {
              setProfiles([...profiles, p]);
            }
          };

          const buildCommand = () => {
            let cmd = 'New-NetFirewallRule `\n';
            cmd += `    -DisplayName "${ruleName}" \`\n`;
            cmd += `    -Direction ${direction} \`\n`;
            cmd += `    -Action ${action} \`\n`;

            if (useProgram) {
              cmd += `    -Program "${program}" \`\n`;
            } else {
              cmd += `    -Protocol ${protocol} \`\n`;
              if (protocol !== 'ICMP') {
                cmd += `    -LocalPort ${port} \`\n`;
              }
            }

            if (remoteIP) {
              cmd += `    -RemoteAddress ${remoteIP} \`\n`;
            }

            cmd += `    -Profile ${profiles.join(',')}`;
            return cmd;
          };

          const presets = [
            { name: 'Web Server HTTP', direction: 'Inbound', action: 'Allow', protocol: 'TCP', port: '80', profiles: ['Private', 'Domain'] },
            { name: 'Web Server HTTPS', direction: 'Inbound', action: 'Allow', protocol: 'TCP', port: '443', profiles: ['Private', 'Domain'] },
            { name: 'SSH Server', direction: 'Inbound', action: 'Allow', protocol: 'TCP', port: '22', profiles: ['Private'] },
            { name: 'Block Telnet', direction: 'Inbound', action: 'Block', protocol: 'TCP', port: '23', profiles: ['Domain', 'Private', 'Public'] },
            { name: 'RDP Access', direction: 'Inbound', action: 'Allow', protocol: 'TCP', port: '3389', profiles: ['Domain', 'Private'] },
          ];

          const applyPreset = (preset) => {
            setRuleName(preset.name);
            setDirection(preset.direction);
            setAction(preset.action);
            setProtocol(preset.protocol);
            setPort(preset.port);
            setProfiles(preset.profiles);
            setUseProgram(false);
          };

          const actionColors = { Allow: colors.success, Block: colors.danger };
          const dirColors = { Inbound: colors.info, Outbound: colors.purple };

          return (
            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '24px' }}>
              <div>
                <h4 style={{ color: colors.textDim, marginBottom: '12px', fontSize: '12px', textTransform: 'uppercase', letterSpacing: '1px' }}>Configurazione Regola</h4>

                <div style={{ display: 'grid', gap: '14px' }}>
                  <div>
                    <label style={{ color: colors.textMuted, fontSize: '11px', display: 'block', marginBottom: '4px' }}>Nome Regola</label>
                    <input
                      type="text"
                      value={ruleName}
                      onChange={(e) => setRuleName(e.target.value)}
                      style={{ width: '100%', padding: '10px', background: colors.bgLight, border: `1px solid ${colors.border}`, borderRadius: '6px', color: colors.text, fontSize: '13px' }}
                    />
                  </div>

                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px' }}>
                    <div>
                      <label style={{ color: colors.textMuted, fontSize: '11px', display: 'block', marginBottom: '4px' }}>Direzione</label>
                      <div style={{ display: 'flex', gap: '6px' }}>
                        {['Inbound', 'Outbound'].map(d => (
                          <button
                            key={d}
                            onClick={() => setDirection(d)}
                            style={{
                              flex: 1,
                              padding: '8px',
                              background: direction === d ? dirColors[d] + '30' : colors.bgLight,
                              border: `1px solid ${direction === d ? dirColors[d] : colors.border}`,
                              borderRadius: '6px',
                              color: direction === d ? dirColors[d] : colors.textDim,
                              cursor: 'pointer',
                              fontSize: '11px'
                            }}
                          >
                            {d === 'Inbound' ? 'üì•' : 'üì§'} {d}
                          </button>
                        ))}
                      </div>
                    </div>

                    <div>
                      <label style={{ color: colors.textMuted, fontSize: '11px', display: 'block', marginBottom: '4px' }}>Azione</label>
                      <div style={{ display: 'flex', gap: '6px' }}>
                        {['Allow', 'Block'].map(a => (
                          <button
                            key={a}
                            onClick={() => setAction(a)}
                            style={{
                              flex: 1,
                              padding: '8px',
                              background: action === a ? actionColors[a] + '30' : colors.bgLight,
                              border: `1px solid ${action === a ? actionColors[a] : colors.border}`,
                              borderRadius: '6px',
                              color: action === a ? actionColors[a] : colors.textDim,
                              cursor: 'pointer',
                              fontSize: '11px'
                            }}
                          >
                            {a === 'Allow' ? '‚úì' : '‚úó'} {a}
                          </button>
                        ))}
                      </div>
                    </div>
                  </div>

                  <div>
                    <label style={{ color: colors.textMuted, fontSize: '11px', display: 'block', marginBottom: '4px' }}>
                      <input
                        type="checkbox"
                        checked={useProgram}
                        onChange={(e) => setUseProgram(e.target.checked)}
                        style={{ marginRight: '6px' }}
                      />
                      Filtra per Applicazione
                    </label>
                    {useProgram ? (
                      <input
                        type="text"
                        value={program}
                        onChange={(e) => setProgram(e.target.value)}
                        placeholder="C:\Path\to\app.exe"
                        style={{ width: '100%', padding: '10px', background: colors.bgLight, border: `1px solid ${colors.border}`, borderRadius: '6px', color: colors.text, fontSize: '12px', fontFamily: 'JetBrains Mono, monospace' }}
                      />
                    ) : (
                      <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px' }}>
                        <select
                          value={protocol}
                          onChange={(e) => setProtocol(e.target.value)}
                          style={{ padding: '10px', background: colors.bgLight, border: `1px solid ${colors.border}`, borderRadius: '6px', color: colors.text, fontSize: '12px' }}
                        >
                          <option value="TCP">TCP</option>
                          <option value="UDP">UDP</option>
                          <option value="ICMP">ICMP</option>
                        </select>
                        {protocol !== 'ICMP' && (
                          <input
                            type="text"
                            value={port}
                            onChange={(e) => setPort(e.target.value)}
                            placeholder="Porta"
                            style={{ padding: '10px', background: colors.bgLight, border: `1px solid ${colors.border}`, borderRadius: '6px', color: colors.text, fontSize: '12px' }}
                          />
                        )}
                      </div>
                    )}
                  </div>

                  <div>
                    <label style={{ color: colors.textMuted, fontSize: '11px', display: 'block', marginBottom: '4px' }}>IP Remoto (opzionale)</label>
                    <input
                      type="text"
                      value={remoteIP}
                      onChange={(e) => setRemoteIP(e.target.value)}
                      placeholder="es. 192.168.1.0/24 o Any"
                      style={{ width: '100%', padding: '10px', background: colors.bgLight, border: `1px solid ${colors.border}`, borderRadius: '6px', color: colors.text, fontSize: '12px' }}
                    />
                  </div>

                  <div>
                    <label style={{ color: colors.textMuted, fontSize: '11px', display: 'block', marginBottom: '4px' }}>Profili</label>
                    <div style={{ display: 'flex', gap: '8px' }}>
                      {['Domain', 'Private', 'Public'].map(p => (
                        <button
                          key={p}
                          onClick={() => toggleProfile(p)}
                          style={{
                            flex: 1,
                            padding: '8px',
                            background: profiles.includes(p) ? colors.accent + '30' : colors.bgLight,
                            border: `1px solid ${profiles.includes(p) ? colors.accent : colors.border}`,
                            borderRadius: '6px',
                            color: profiles.includes(p) ? colors.accent : colors.textDim,
                            cursor: 'pointer',
                            fontSize: '10px'
                          }}
                        >
                          {p === 'Domain' ? 'üè¢' : p === 'Private' ? 'üè†' : '‚òï'} {p}
                        </button>
                      ))}
                    </div>
                  </div>
                </div>

                <div style={{ marginTop: '16px' }}>
                  <label style={{ color: colors.textMuted, fontSize: '11px', display: 'block', marginBottom: '8px' }}>Preset Comuni</label>
                  <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>
                    {presets.map((preset, idx) => (
                      <button
                        key={idx}
                        onClick={() => applyPreset(preset)}
                        style={{
                          padding: '6px 10px',
                          background: colors.bgLight,
                          border: `1px solid ${colors.border}`,
                          borderRadius: '6px',
                          color: colors.textDim,
                          cursor: 'pointer',
                          fontSize: '10px'
                        }}
                      >
                        {preset.name}
                      </button>
                    ))}
                  </div>
                </div>
              </div>

              <div>
                <h4 style={{ color: colors.textDim, marginBottom: '12px', fontSize: '12px', textTransform: 'uppercase', letterSpacing: '1px' }}>Comando PowerShell Generato</h4>

                <div style={{ background: '#0d1117', borderRadius: '8px', border: `1px solid ${colors.border}`, overflow: 'hidden' }}>
                  <div style={{ background: '#161b22', padding: '8px 16px', borderBottom: `1px solid ${colors.border}`, display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
                    <span style={{ fontFamily: 'monospace', fontSize: '11px', color: colors.textDim }}>
                      <span style={{ color: colors.info }}>‚óè</span> PowerShell
                    </span>
                    <button
                      onClick={() => navigator.clipboard?.writeText(buildCommand())}
                      style={{ padding: '4px 8px', background: colors.bgLight, border: 'none', borderRadius: '4px', color: colors.textDim, cursor: 'pointer', fontSize: '10px' }}
                    >
                      üìã Copia
                    </button>
                  </div>
                  <pre style={{ margin: 0, padding: '14px', fontFamily: 'JetBrains Mono, monospace', fontSize: '11px', lineHeight: '1.6', color: colors.text, overflowX: 'auto' }}>
                    <span style={{ color: colors.cyan }}>New-NetFirewallRule</span> `{'\n'}
                    {'    '}<span style={{ color: colors.warn }}>-DisplayName</span> <span style={{ color: colors.success }}>"{ruleName}"</span> `{'\n'}
                    {'    '}<span style={{ color: colors.warn }}>-Direction</span> <span style={{ color: dirColors[direction] }}>{direction}</span> `{'\n'}
                    {'    '}<span style={{ color: colors.warn }}>-Action</span> <span style={{ color: actionColors[action] }}>{action}</span> `{'\n'}
                    {useProgram ? (
                      <>{'    '}<span style={{ color: colors.warn }}>-Program</span> <span style={{ color: colors.success }}>"{program}"</span> `{'\n'}</>
                    ) : (
                      <>
                        {'    '}<span style={{ color: colors.warn }}>-Protocol</span> <span style={{ color: colors.purple }}>{protocol}</span> `{'\n'}
                        {protocol !== 'ICMP' && <>{'    '}<span style={{ color: colors.warn }}>-LocalPort</span> <span style={{ color: colors.info }}>{port}</span> `{'\n'}</>}
                      </>
                    )}
                    {remoteIP && <>{'    '}<span style={{ color: colors.warn }}>-RemoteAddress</span> <span style={{ color: colors.accent }}>{remoteIP}</span> `{'\n'}</>}
                    {'    '}<span style={{ color: colors.warn }}>-Profile</span> <span style={{ color: colors.accent }}>{profiles.join(',')}</span>
                  </pre>
                </div>

                <div style={{ marginTop: '16px', padding: '14px', background: colors.bgLight, borderRadius: '8px' }}>
                  <h5 style={{ color: colors.accent, marginBottom: '8px', fontSize: '12px' }}>üìã Riepilogo Regola</h5>
                  <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '8px', fontSize: '12px' }}>
                    <div><span style={{ color: colors.textMuted }}>Nome:</span> <span style={{ color: colors.text }}>{ruleName}</span></div>
                    <div><span style={{ color: colors.textMuted }}>Azione:</span> <span style={{ color: actionColors[action] }}>{action}</span></div>
                    <div><span style={{ color: colors.textMuted }}>Direzione:</span> <span style={{ color: dirColors[direction] }}>{direction}</span></div>
                    <div><span style={{ color: colors.textMuted }}>Target:</span> <span style={{ color: colors.text }}>{useProgram ? 'Applicazione' : `${protocol}/${port}`}</span></div>
                    <div style={{ gridColumn: 'span 2' }}><span style={{ color: colors.textMuted }}>Profili:</span> <span style={{ color: colors.accent }}>{profiles.join(', ')}</span></div>
                  </div>
                </div>
              </div>
            </div>
          );
        };

        return (
          <div style={{ padding: '30px' }}>
            <h2 style={{ color: colors.accent, marginBottom: '8px' }}>üîß Simulatore: PowerShell Rule Builder</h2>
            <p style={{ color: colors.textDim, marginBottom: '24px' }}>Costruisci comandi New-NetFirewallRule interattivamente</p>
            <PowerShellRuleBuilder />
          </div>
        );
      },
    ];

    function App() {
      const [current, setCurrent] = useState(0);
      const total = slides.length;
      const next = () => setCurrent(c => Math.min(c + 1, total - 1));
      const prev = () => setCurrent(c => Math.max(c - 1, 0));
      useEffect(() => { const handler = e => { if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); next(); } if (e.key === 'ArrowLeft') { e.preventDefault(); prev(); } if (e.key === 'Escape') window.location.href = 'index.html'; }; window.addEventListener('keydown', handler); return () => window.removeEventListener('keydown', handler); }, []);
      return (<div style={{ minHeight: '100vh', background: colors.bg }}><div style={{ position: 'fixed', top: 0, left: 0, right: 0, height: '50px', background: colors.bgCard + 'e0', backdropFilter: 'blur(10px)', borderBottom: `1px solid ${colors.border}`, display: 'flex', alignItems: 'center', justifyContent: 'space-between', padding: '0 20px', zIndex: 100 }}><div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}><a href="index.html" style={{ color: colors.textMuted, textDecoration: 'none', fontSize: '13px' }}>‚Üê Indice</a><span style={{ color: colors.border }}>|</span><span style={{ color: colors.accent, fontWeight: '600' }}>Modulo 5</span><span style={{ color: colors.textDim }}>Windows Firewall</span></div><div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}><span style={{ color: colors.textMuted, fontSize: '13px' }}>{current + 1} / {total}</span><div style={{ width: '100px', height: '4px', background: colors.bgLight, borderRadius: '2px' }}><div style={{ height: '100%', width: `${((current + 1) / total) * 100}%`, background: colors.accent, borderRadius: '2px', transition: 'width 0.3s' }} /></div></div></div><div style={{ paddingTop: '50px', paddingBottom: '70px', minHeight: 'calc(100vh - 120px)' }}><div style={{ maxWidth: '1200px', margin: '0 auto', padding: '0 24px' }}>{slides[current]()}</div></div><div style={{ position: 'fixed', bottom: 0, left: 0, right: 0, height: '60px', background: colors.bgCard + 'e0', backdropFilter: 'blur(10px)', borderTop: `1px solid ${colors.border}`, display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '16px', zIndex: 100 }}>{current === 0 && <a href="modulo4-linux-firewall.html" style={{ padding: '10px 24px', background: colors.bgCard, border: `1px solid ${colors.border}`, borderRadius: '8px', color: colors.text, textDecoration: 'none', fontSize: '14px' }}>‚Üê Modulo 4</a>}{current > 0 && <button onClick={prev} style={{ padding: '10px 24px', background: colors.bgCard, border: `1px solid ${colors.border}`, borderRadius: '8px', color: colors.text, cursor: 'pointer', fontSize: '14px' }}>‚Üê Indietro</button>}<button onClick={next} disabled={current === total - 1} style={{ padding: '10px 24px', background: current === total - 1 ? colors.bgLight : `linear-gradient(135deg, ${colors.accent}, ${colors.accentAlt})`, border: 'none', borderRadius: '8px', color: current === total - 1 ? colors.textMuted : '#000', cursor: current === total - 1 ? 'not-allowed' : 'pointer', fontSize: '14px', fontWeight: '600' }}>Avanti ‚Üí</button>{current === total - 1 && <a href="modulo6-quiz.html" style={{ padding: '10px 24px', background: `linear-gradient(135deg, ${colors.danger}, #dc2626)`, border: 'none', borderRadius: '8px', color: '#fff', textDecoration: 'none', fontSize: '14px', fontWeight: '600' }}>Modulo 6 ‚Üí</a>}</div></div>);
    }
    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
