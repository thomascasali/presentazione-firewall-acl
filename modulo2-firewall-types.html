<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Modulo 2 - Tipologie Firewall</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: #0a0e17; color: #f1f5f9; font-family: 'Inter', sans-serif; }
    #root { min-height: 100vh; }
    @media (max-width: 768px) {
      .slide-content { padding: 16px !important; }
      .slide-content h1 { font-size: 28px !important; }
      .slide-content h2 { font-size: 20px !important; }
      .slide-content h3 { font-size: 16px !important; }
      svg { max-width: 100%; height: auto; }
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    const colors = {
      bg: '#0a0e17', bgCard: '#111827', bgLight: '#1e293b',
      accent: '#22c55e', accentAlt: '#4ade80',
      text: '#f1f5f9', textDim: '#94a3b8', textMuted: '#64748b',
      border: '#334155',
      success: '#22c55e', danger: '#ef4444', warn: '#f59e0b', info: '#0ea5e9', purple: '#a78bfa', cyan: '#22d3ee'
    };

    const Code = ({ children, title }) => (
      <div style={{ background: '#0d1117', borderRadius: '8px', border: `1px solid ${colors.border}`, margin: '12px 0', overflow: 'hidden' }}>
        {title && <div style={{ background: '#161b22', padding: '8px 16px', borderBottom: `1px solid ${colors.border}`, fontFamily: 'monospace', fontSize: '11px', color: colors.textDim }}><span style={{color: colors.accent}}>‚óè</span> {title}</div>}
        <pre style={{ margin: 0, padding: '14px', fontFamily: 'JetBrains Mono, monospace', fontSize: '12px', lineHeight: '1.5', color: colors.text, overflowX: 'auto' }}>{children}</pre>
      </div>
    );

    const Box = ({ type = 'info', title, children }) => {
      const cfg = { info: { c: colors.info, i: '‚ÑπÔ∏è' }, warn: { c: colors.warn, i: '‚ö†Ô∏è' }, danger: { c: colors.danger, i: 'üõë' }, tip: { c: colors.purple, i: 'üí°' }, success: { c: colors.success, i: '‚úì' } };
      const { c, i } = cfg[type];
      return (
        <div style={{ background: c + '15', border: `1px solid ${c}40`, borderLeft: `4px solid ${c}`, borderRadius: '0 8px 8px 0', padding: '14px 18px', margin: '14px 0' }}>
          <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '6px', fontWeight: '600', color: c }}>{i} {title}</div>
          <div style={{ color: colors.textDim, lineHeight: '1.5', fontSize: '13px' }}>{children}</div>
        </div>
      );
    };

    const Table = ({ headers, rows }) => (
      <div style={{ overflowX: 'auto', margin: '16px 0' }}>
        <table style={{ width: '100%', borderCollapse: 'collapse', fontSize: '13px' }}>
          <thead><tr>{headers.map((h, i) => <th key={i} style={{ background: colors.bgLight, color: colors.accent, padding: '10px 12px', textAlign: 'left', borderBottom: `2px solid ${colors.accent}40`, fontSize: '12px' }}>{h}</th>)}</tr></thead>
          <tbody>{rows.map((row, ri) => <tr key={ri}>{row.map((cell, ci) => <td key={ci} style={{ padding: '10px 12px', borderBottom: `1px solid ${colors.border}`, color: ci === 0 ? colors.text : colors.textDim, background: ri % 2 ? colors.bgLight + '40' : 'transparent' }}>{cell}</td>)}</tr>)}</tbody>
        </table>
      </div>
    );

    const Glow = ({ children, color = colors.accent }) => (
      <div style={{ position: 'relative', padding: '2px', borderRadius: '12px', background: `linear-gradient(135deg, ${color}40, transparent, ${color}20)` }}>
        <div style={{ background: colors.bgCard, borderRadius: '10px', padding: '20px' }}>{children}</div>
      </div>
    );

    // Packet Inspector Simulator
    const PacketInspector = () => {
      const [fwType, setFwType] = useState(0);
      const types = [
        { name: 'Packet Filter', layers: [3, 4], color: colors.warn, desc: 'Analizza solo IP e porte' },
        { name: 'Stateful', layers: [3, 4], color: colors.info, desc: 'Analizza IP, porte + stato connessione', extra: 'state' },
        { name: 'Application Level', layers: [3, 4, 7], color: colors.purple, desc: 'Analizza anche contenuto applicativo', extra: 'content' },
        { name: 'NGFW', layers: [3, 4, 7], color: colors.success, desc: 'Deep inspection + IPS + threat intelligence', extra: 'all' },
      ];
      const packet = {
        l3: { src: '192.168.1.100', dst: '93.184.216.34', proto: 'IP', ttl: 64 },
        l4: { srcPort: 52431, dstPort: 443, proto: 'TCP', flags: 'SYN' },
        l7: { method: 'GET', host: 'example.com', path: '/login', cookie: 'session=abc123', ua: 'Mozilla/5.0' },
        state: { status: 'NEW', direction: 'OUTBOUND', tracked: true },
        threat: { reputation: 'Clean', category: 'Business', ssl: 'Valid cert' }
      };
      const t = types[fwType];
      return (
        <div style={{ background: colors.bgCard, borderRadius: '12px', padding: '20px', border: `1px solid ${colors.border}` }}>
          <h3 style={{ color: colors.accent, marginBottom: '16px' }}>üî¨ Packet Inspector - Cosa vede ogni firewall?</h3>
          <div style={{ display: 'flex', gap: '8px', marginBottom: '16px', flexWrap: 'wrap' }}>
            {types.map((type, i) => (
              <button key={i} onClick={() => setFwType(i)} style={{ padding: '8px 14px', background: fwType === i ? type.color : colors.bgLight, border: 'none', borderRadius: '6px', color: fwType === i ? '#000' : colors.text, cursor: 'pointer', fontSize: '11px', fontWeight: fwType === i ? '600' : '400' }}>{type.name}</button>
            ))}
          </div>
          <p style={{ color: colors.textDim, fontSize: '13px', marginBottom: '16px' }}>{t.desc}</p>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '12px' }}>
            <div style={{ background: t.layers.includes(3) ? colors.warn + '20' : colors.bg, border: `2px solid ${t.layers.includes(3) ? colors.warn : colors.border}`, borderRadius: '8px', padding: '12px', opacity: t.layers.includes(3) ? 1 : 0.4 }}>
              <div style={{ color: colors.warn, fontWeight: '600', fontSize: '12px', marginBottom: '8px' }}>Layer 3 - Network</div>
              <div style={{ fontFamily: 'monospace', fontSize: '11px', color: colors.text, lineHeight: '1.6' }}>
                <div>Src IP: <span style={{ color: colors.accent }}>{packet.l3.src}</span></div>
                <div>Dst IP: <span style={{ color: colors.accent }}>{packet.l3.dst}</span></div>
                <div>Protocol: {packet.l3.proto}</div>
              </div>
            </div>
            <div style={{ background: t.layers.includes(4) ? colors.cyan + '20' : colors.bg, border: `2px solid ${t.layers.includes(4) ? colors.cyan : colors.border}`, borderRadius: '8px', padding: '12px', opacity: t.layers.includes(4) ? 1 : 0.4 }}>
              <div style={{ color: colors.cyan, fontWeight: '600', fontSize: '12px', marginBottom: '8px' }}>Layer 4 - Transport</div>
              <div style={{ fontFamily: 'monospace', fontSize: '11px', color: colors.text, lineHeight: '1.6' }}>
                <div>Src Port: <span style={{ color: colors.accent }}>{packet.l4.srcPort}</span></div>
                <div>Dst Port: <span style={{ color: colors.accent }}>{packet.l4.dstPort}</span> (HTTPS)</div>
                <div>Flags: {packet.l4.flags}</div>
              </div>
            </div>
            {(t.extra === 'state' || t.extra === 'all') && (
              <div style={{ background: colors.info + '20', border: `2px solid ${colors.info}`, borderRadius: '8px', padding: '12px' }}>
                <div style={{ color: colors.info, fontWeight: '600', fontSize: '12px', marginBottom: '8px' }}>üîÑ Connection State</div>
                <div style={{ fontFamily: 'monospace', fontSize: '11px', color: colors.text, lineHeight: '1.6' }}>
                  <div>Status: <span style={{ color: colors.success }}>{packet.state.status}</span></div>
                  <div>Direction: {packet.state.direction}</div>
                  <div>Tracked: {packet.state.tracked ? '‚úì' : '‚úó'}</div>
                </div>
              </div>
            )}
            {(t.extra === 'content' || t.extra === 'all') && (
              <div style={{ background: colors.purple + '20', border: `2px solid ${colors.purple}`, borderRadius: '8px', padding: '12px' }}>
                <div style={{ color: colors.purple, fontWeight: '600', fontSize: '12px', marginBottom: '8px' }}>Layer 7 - Application</div>
                <div style={{ fontFamily: 'monospace', fontSize: '11px', color: colors.text, lineHeight: '1.6' }}>
                  <div>{packet.l7.method} {packet.l7.path}</div>
                  <div>Host: <span style={{ color: colors.accent }}>{packet.l7.host}</span></div>
                  <div>Cookie: {packet.l7.cookie.substring(0, 15)}...</div>
                </div>
              </div>
            )}
            {t.extra === 'all' && (
              <div style={{ background: colors.success + '20', border: `2px solid ${colors.success}`, borderRadius: '8px', padding: '12px' }}>
                <div style={{ color: colors.success, fontWeight: '600', fontSize: '12px', marginBottom: '8px' }}>üõ°Ô∏è Threat Intelligence</div>
                <div style={{ fontFamily: 'monospace', fontSize: '11px', color: colors.text, lineHeight: '1.6' }}>
                  <div>Reputation: <span style={{ color: colors.success }}>{packet.threat.reputation}</span></div>
                  <div>Category: {packet.threat.category}</div>
                  <div>SSL: {packet.threat.ssl}</div>
                </div>
              </div>
            )}
          </div>
        </div>
      );
    };

    // Stateful Connection Tracker
    const StatefulConnectionTracker = () => {
      const [connections, setConnections] = useState([]);
      const [log, setLog] = useState([]);

      const addConnection = (type) => {
        const id = Math.random().toString(36).substr(2, 6);
        const ports = { http: 80, https: 443, ssh: 22, dns: 53 };
        const conn = {
          id,
          srcIP: `192.168.1.${Math.floor(Math.random() * 200) + 10}`,
          srcPort: Math.floor(Math.random() * 30000) + 30000,
          dstIP: `${Math.floor(Math.random() * 200) + 50}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`,
          dstPort: ports[type],
          proto: type === 'dns' ? 'UDP' : 'TCP',
          state: 'NEW',
          type,
          ttl: 30
        };
        setConnections(c => [...c, conn]);
        setLog(l => [...l, { time: new Date().toLocaleTimeString(), msg: `NEW ${conn.proto} ${conn.srcIP}:${conn.srcPort} ‚Üí ${conn.dstIP}:${conn.dstPort}`, color: colors.success }].slice(-6));

        setTimeout(() => {
          setConnections(c => c.map(x => x.id === id ? { ...x, state: 'ESTABLISHED' } : x));
          setLog(l => [...l, { time: new Date().toLocaleTimeString(), msg: `ESTABLISHED ${conn.srcIP}:${conn.srcPort}`, color: colors.info }].slice(-6));
        }, 1000);

        setTimeout(() => {
          setConnections(c => c.filter(x => x.id !== id));
          setLog(l => [...l, { time: new Date().toLocaleTimeString(), msg: `CLOSED ${conn.srcIP}:${conn.srcPort} (timeout)`, color: colors.textMuted }].slice(-6));
        }, 8000);
      };

      return (
        <div style={{ background: colors.bgCard, borderRadius: '12px', padding: '20px', border: `1px solid ${colors.border}` }}>
          <h3 style={{ color: colors.accent, marginBottom: '16px' }}>üîÑ Stateful Connection Tracker</h3>
          <p style={{ color: colors.textDim, fontSize: '13px', marginBottom: '16px' }}>Simula la tabella connessioni di un firewall stateful. Le connessioni vengono tracciate e poi scadono.</p>
          <div style={{ display: 'flex', gap: '8px', marginBottom: '16px', flexWrap: 'wrap' }}>
            <button onClick={() => addConnection('http')} style={{ padding: '8px 14px', background: colors.success, border: 'none', borderRadius: '6px', color: '#fff', cursor: 'pointer', fontSize: '11px' }}>+ HTTP (80)</button>
            <button onClick={() => addConnection('https')} style={{ padding: '8px 14px', background: colors.info, border: 'none', borderRadius: '6px', color: '#fff', cursor: 'pointer', fontSize: '11px' }}>+ HTTPS (443)</button>
            <button onClick={() => addConnection('ssh')} style={{ padding: '8px 14px', background: colors.purple, border: 'none', borderRadius: '6px', color: '#fff', cursor: 'pointer', fontSize: '11px' }}>+ SSH (22)</button>
            <button onClick={() => addConnection('dns')} style={{ padding: '8px 14px', background: colors.warn, border: 'none', borderRadius: '6px', color: '#fff', cursor: 'pointer', fontSize: '11px' }}>+ DNS (53)</button>
          </div>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '16px' }}>
            <div>
              <div style={{ color: colors.textDim, fontSize: '11px', marginBottom: '8px', textTransform: 'uppercase' }}>Connection Table ({connections.length} active)</div>
              <div style={{ background: colors.bg, borderRadius: '8px', padding: '10px', minHeight: '150px', maxHeight: '200px', overflowY: 'auto' }}>
                {connections.length === 0 ? (
                  <div style={{ color: colors.textMuted, fontSize: '12px', textAlign: 'center', padding: '40px' }}>Nessuna connessione attiva</div>
                ) : connections.map(c => (
                  <div key={c.id} style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', padding: '6px 8px', background: colors.bgLight, borderRadius: '4px', marginBottom: '4px', fontSize: '10px', fontFamily: 'monospace' }}>
                    <span style={{ color: colors.text }}>{c.srcIP}:{c.srcPort}</span>
                    <span style={{ color: colors.textMuted }}>‚Üí</span>
                    <span style={{ color: colors.accent }}>{c.dstPort}</span>
                    <span style={{ padding: '2px 6px', background: c.state === 'NEW' ? colors.success + '30' : colors.info + '30', borderRadius: '3px', color: c.state === 'NEW' ? colors.success : colors.info, fontSize: '9px' }}>{c.state}</span>
                  </div>
                ))}
              </div>
            </div>
            <div>
              <div style={{ color: colors.textDim, fontSize: '11px', marginBottom: '8px', textTransform: 'uppercase' }}>Event Log</div>
              <div style={{ background: colors.bg, borderRadius: '8px', padding: '10px', minHeight: '150px', maxHeight: '200px', overflowY: 'auto' }}>
                {log.length === 0 ? (
                  <div style={{ color: colors.textMuted, fontSize: '12px', textAlign: 'center', padding: '40px' }}>In attesa di eventi...</div>
                ) : log.map((entry, i) => (
                  <div key={i} style={{ fontSize: '10px', fontFamily: 'monospace', marginBottom: '4px', color: entry.color }}>
                    <span style={{ color: colors.textMuted }}>[{entry.time}]</span> {entry.msg}
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    };

    const OSILayer = ({ layer, name, color, active }) => (
      <div style={{ display: 'flex', alignItems: 'center', gap: '10px', padding: '8px 14px', background: active ? color + '30' : colors.bgLight, border: `2px solid ${active ? color : 'transparent'}`, borderRadius: '6px', marginBottom: '4px' }}>
        <span style={{ width: '24px', height: '24px', background: color, borderRadius: '4px', display: 'flex', alignItems: 'center', justifyContent: 'center', color: '#000', fontWeight: 'bold', fontSize: '12px' }}>{layer}</span>
        <span style={{ color: active ? color : colors.textMuted, fontWeight: active ? '600' : '400' }}>{name}</span>
      </div>
    );

    const slides = [
      // Slide 1: Title
      () => (
        <div style={{ textAlign: 'center', padding: '60px 30px', display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', minHeight: '70vh' }}>
          <div style={{ fontSize: '48px', marginBottom: '20px' }}>üõ°Ô∏è</div>
          <div style={{ fontSize: '12px', color: colors.accent, textTransform: 'uppercase', letterSpacing: '3px', marginBottom: '16px' }}>Modulo 2</div>
          <h1 style={{ fontSize: '42px', fontWeight: '700', background: `linear-gradient(135deg, ${colors.accent}, ${colors.accentAlt})`, WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent', marginBottom: '16px' }}>Tipologie di Firewall</h1>
          <p style={{ fontSize: '18px', color: colors.textDim, maxWidth: '500px', lineHeight: '1.6' }}>Packet Filter, Stateful Inspection, Application Level e Next-Generation Firewall</p>
        </div>
      ),

      // Slide 2: Overview OSI
      () => (
        <div style={{ padding: '30px' }}>
          <h2 style={{ color: colors.accent, marginBottom: '24px' }}>üìä Firewall e Modello OSI</h2>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '24px' }}>
            <div>
              <h4 style={{ color: colors.textDim, marginBottom: '12px', fontSize: '12px', textTransform: 'uppercase' }}>Livelli OSI</h4>
              <OSILayer layer="7" name="Application" color={colors.purple} active={true} />
              <OSILayer layer="6" name="Presentation" color={colors.purple} active={false} />
              <OSILayer layer="5" name="Session" color={colors.purple} active={false} />
              <OSILayer layer="4" name="Transport" color={colors.cyan} active={true} />
              <OSILayer layer="3" name="Network" color={colors.warn} active={true} />
              <OSILayer layer="2" name="Data Link" color={colors.textMuted} active={false} />
              <OSILayer layer="1" name="Physical" color={colors.textMuted} active={false} />
            </div>
            <div>
              <Glow>
                <h3 style={{ color: colors.accent, marginBottom: '14px' }}>Dove operano i firewall?</h3>
                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '16px' }}>
                  <div style={{ background: colors.bgLight, padding: '14px', borderRadius: '8px' }}>
                    <div style={{ color: colors.warn, fontWeight: '600', marginBottom: '6px' }}>Packet Filter</div>
                    <div style={{ color: colors.textDim, fontSize: '13px' }}>Layer 3-4: IP, TCP/UDP headers</div>
                  </div>
                  <div style={{ background: colors.bgLight, padding: '14px', borderRadius: '8px' }}>
                    <div style={{ color: colors.cyan, fontWeight: '600', marginBottom: '6px' }}>Stateful</div>
                    <div style={{ color: colors.textDim, fontSize: '13px' }}>Layer 3-4: + tracking connessioni</div>
                  </div>
                  <div style={{ background: colors.bgLight, padding: '14px', borderRadius: '8px' }}>
                    <div style={{ color: colors.purple, fontWeight: '600', marginBottom: '6px' }}>Application Level</div>
                    <div style={{ color: colors.textDim, fontSize: '13px' }}>Layer 7: HTTP, FTP, SMTP...</div>
                  </div>
                  <div style={{ background: colors.bgLight, padding: '14px', borderRadius: '8px' }}>
                    <div style={{ color: colors.success, fontWeight: '600', marginBottom: '6px' }}>NGFW</div>
                    <div style={{ color: colors.textDim, fontSize: '13px' }}>Layer 3-7: Tutto integrato</div>
                  </div>
                </div>
              </Glow>
              <Box type="info" title="Regola generale">
                Pi√π alto il livello OSI ‚Üí pi√π dettagliata l'analisi ‚Üí pi√π lento il processing ‚Üí maggiore sicurezza.
              </Box>
            </div>
          </div>
        </div>
      ),

      // Slide 3: Packet Filter
      () => (
        <div style={{ padding: '30px' }}>
          <h2 style={{ color: colors.warn, marginBottom: '24px', display: 'flex', alignItems: 'center', gap: '12px' }}>
            <span style={{ fontSize: '28px' }}>1Ô∏è‚É£</span> Packet Filter Firewall
          </h2>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '24px' }}>
            <div>
              <Glow color={colors.warn}>
                <h3 style={{ color: colors.warn, marginBottom: '12px' }}>Caratteristiche</h3>
                <ul style={{ color: colors.textDim, lineHeight: '1.8', paddingLeft: '18px' }}>
                  <li>Opera a livello <strong style={{ color: colors.text }}>Network (L3)</strong> e <strong style={{ color: colors.text }}>Transport (L4)</strong></li>
                  <li>Analizza <strong style={{ color: colors.text }}>SOLO gli header</strong> dei pacchetti</li>
                  <li>Non mantiene stato (<strong style={{ color: colors.danger }}>stateless</strong>)</li>
                  <li>Molto <strong style={{ color: colors.success }}>veloce</strong> ma meno sicuro</li>
                  <li>Non pu√≤ ispezionare il payload</li>
                </ul>
              </Glow>
              <Box type="danger" title="Limitazione Critica">
                Un virus dentro un'email passa tranquillamente se la porta SMTP (25) √® aperta.
                Il Packet Filter vede solo: "porta 25, permesso" - non analizza il contenuto!
              </Box>
            </div>
            <div>
              <h3 style={{ color: colors.text, marginBottom: '12px' }}>üìã Cosa pu√≤ controllare:</h3>
              <Table headers={['Campo', 'Header', 'Esempio']} rows={[
                ['IP Sorgente', 'IP', '192.168.1.100'],
                ['IP Destinazione', 'IP', '8.8.8.8'],
                ['Protocollo', 'IP', 'TCP/UDP/ICMP'],
                ['Porta Sorgente', 'TCP/UDP', '52341'],
                ['Porta Destinazione', 'TCP/UDP', '80, 443'],
                ['Flag TCP', 'TCP', 'SYN, ACK, FIN'],
              ]} />
              <svg viewBox="0 0 300 100" style={{ width: '100%', marginTop: '16px' }}>
                <rect x="10" y="20" width="280" height="60" fill={colors.bgLight} stroke={colors.border} rx="6" />
                <rect x="20" y="30" width="80" height="40" fill={colors.warn + '40'} stroke={colors.warn} rx="4" />
                <text x="60" y="55" textAnchor="middle" fill={colors.warn} fontSize="10" fontWeight="bold">IP Header</text>
                <rect x="110" y="30" width="80" height="40" fill={colors.cyan + '40'} stroke={colors.cyan} rx="4" />
                <text x="150" y="55" textAnchor="middle" fill={colors.cyan} fontSize="10" fontWeight="bold">TCP Header</text>
                <rect x="200" y="30" width="80" height="40" fill={colors.bgCard} stroke={colors.textMuted} rx="4" strokeDasharray="4,2" />
                <text x="240" y="55" textAnchor="middle" fill={colors.textMuted} fontSize="10">Payload üîí</text>
                <text x="150" y="95" textAnchor="middle" fill={colors.textDim} fontSize="9">‚úì Analizzato | üîí Non analizzato</text>
              </svg>
            </div>
          </div>
        </div>
      ),

      // Slide 4: Stateful
      () => (
        <div style={{ padding: '30px' }}>
          <h2 style={{ color: colors.cyan, marginBottom: '24px', display: 'flex', alignItems: 'center', gap: '12px' }}>
            <span style={{ fontSize: '28px' }}>2Ô∏è‚É£</span> Stateful Inspection Firewall
          </h2>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '24px' }}>
            <div>
              <Glow color={colors.cyan}>
                <h3 style={{ color: colors.cyan, marginBottom: '12px' }}>Come Funziona</h3>
                <p style={{ color: colors.textDim, lineHeight: '1.6', marginBottom: '14px' }}>
                  Mantiene una <strong style={{ color: colors.accent }}>tabella di stato</strong> (state table)
                  che traccia tutte le connessioni attive.
                </p>
                <ul style={{ color: colors.textDim, lineHeight: '1.7', paddingLeft: '18px' }}>
                  <li>Traccia il <strong style={{ color: colors.text }}>3-way handshake</strong> TCP</li>
                  <li>Permette risposte solo a connessioni <strong style={{ color: colors.success }}>legittime</strong></li>
                  <li>Blocca pacchetti "orfani" o fuori sequenza</li>
                  <li>Gestisce automaticamente i timeout</li>
                </ul>
              </Glow>
              <Box type="success" title="Vantaggio Chiave">
                Con una sola regola <code style={{ background: colors.bgLight, padding: '2px 6px', borderRadius: '4px' }}>ESTABLISHED,RELATED ‚Üí ACCEPT</code>
                permetti tutto il traffico di ritorno senza aprire porte manualmente!
              </Box>
            </div>
            <div>
              <h3 style={{ color: colors.text, marginBottom: '12px' }}>üìä Stati delle Connessioni</h3>
              <Table headers={['Stato', 'Descrizione', 'Esempio']} rows={[
                ['NEW', 'Primo pacchetto', 'SYN iniziale'],
                ['ESTABLISHED', 'Connessione attiva', 'Dopo SYN-ACK'],
                ['RELATED', 'Correlata a esistente', 'FTP data channel'],
                ['INVALID', 'Non riconosciuto', 'ACK senza SYN'],
              ]} />
              <svg viewBox="0 0 320 120" style={{ width: '100%', marginTop: '16px', background: colors.bgCard, borderRadius: '8px', padding: '10px' }}>
                <text x="160" y="20" textAnchor="middle" fill={colors.cyan} fontSize="11" fontWeight="bold">TCP 3-Way Handshake</text>
                <rect x="30" y="35" width="60" height="70" fill={colors.bgLight} stroke={colors.info} rx="6" />
                <text x="60" y="75" textAnchor="middle" fill={colors.info} fontSize="10">Client</text>
                <rect x="230" y="35" width="60" height="70" fill={colors.bgLight} stroke={colors.success} rx="6" />
                <text x="260" y="75" textAnchor="middle" fill={colors.success} fontSize="10">Server</text>
                <line x1="90" y1="50" x2="230" y2="50" stroke={colors.warn} strokeWidth="2" markerEnd="url(#arr)" />
                <text x="160" y="45" textAnchor="middle" fill={colors.warn} fontSize="9">1. SYN (NEW)</text>
                <line x1="230" y1="70" x2="90" y2="70" stroke={colors.purple} strokeWidth="2" />
                <text x="160" y="65" textAnchor="middle" fill={colors.purple} fontSize="9">2. SYN-ACK</text>
                <line x1="90" y1="90" x2="230" y2="90" stroke={colors.success} strokeWidth="2" />
                <text x="160" y="85" textAnchor="middle" fill={colors.success} fontSize="9">3. ACK (ESTABLISHED)</text>
              </svg>
            </div>
          </div>
        </div>
      ),

      // Slide 5: Application Level
      () => (
        <div style={{ padding: '30px' }}>
          <h2 style={{ color: colors.purple, marginBottom: '24px', display: 'flex', alignItems: 'center', gap: '12px' }}>
            <span style={{ fontSize: '28px' }}>3Ô∏è‚É£</span> Application Level Firewall
          </h2>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '24px' }}>
            <div>
              <Glow color={colors.purple}>
                <h3 style={{ color: colors.purple, marginBottom: '12px' }}>Caratteristiche</h3>
                <ul style={{ color: colors.textDim, lineHeight: '1.8', paddingLeft: '18px' }}>
                  <li>Opera a livello <strong style={{ color: colors.text }}>Application (L7)</strong></li>
                  <li>Analizza il <strong style={{ color: colors.success }}>CONTENUTO</strong> dei pacchetti</li>
                  <li>Comprende i protocolli applicativi (HTTP, SMTP, FTP...)</li>
                  <li>Agisce come <strong style={{ color: colors.text }}>PROXY</strong></li>
                  <li>Pu√≤ terminare e rigenerare le connessioni</li>
                </ul>
              </Glow>
              <Box type="warn" title="Trade-off">
                Maggiore sicurezza = maggiore latenza. La Deep Packet Inspection richiede risorse computazionali significative.
              </Box>
            </div>
            <div>
              <h3 style={{ color: colors.text, marginBottom: '12px' }}>üõ°Ô∏è Cosa pu√≤ bloccare:</h3>
              <div style={{ display: 'grid', gap: '8px' }}>
                {[
                  ['üîó', 'URL malevoli', 'http://malware.com/virus.exe'],
                  ['üíâ', 'SQL Injection', "'; DROP TABLE users;--"],
                  ['üìú', 'XSS', '&lt;script&gt;steal(cookies)&lt;/script&gt;'],
                  ['üìÅ', 'File pericolosi', 'upload di .exe, .bat'],
                  ['üìß', 'Email spam/phishing', 'Contenuto sospetto'],
                  ['üîí', 'Certificati invalidi', 'SSL/TLS inspection'],
                ].map(([icon, name, example]) => (
                  <div key={name} style={{ display: 'flex', alignItems: 'center', gap: '12px', padding: '10px 14px', background: colors.bgLight, borderRadius: '6px' }}>
                    <span style={{ fontSize: '18px' }}>{icon}</span>
                    <div>
                      <div style={{ color: colors.text, fontSize: '13px', fontWeight: '500' }}>{name}</div>
                      <div style={{ color: colors.textMuted, fontSize: '11px', fontFamily: 'monospace' }}>{example}</div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      ),

      // Slide 6: Proxy Operation
      () => (
        <div style={{ padding: '30px' }}>
          <h2 style={{ color: colors.purple, marginBottom: '24px' }}>üîÑ Come funziona il Proxy</h2>
          <svg viewBox="0 0 600 200" style={{ width: '100%', maxWidth: '600px', margin: '0 auto 24px', display: 'block', background: colors.bgCard, borderRadius: '12px', padding: '20px' }}>
            <rect x="40" y="70" width="80" height="60" fill={colors.bgLight} stroke={colors.info} strokeWidth="2" rx="8" />
            <text x="80" y="95" textAnchor="middle" fill={colors.info} fontSize="24">üíª</text>
            <text x="80" y="120" textAnchor="middle" fill={colors.info} fontSize="10">Client</text>
            <rect x="220" y="40" width="160" height="120" fill={colors.purple + '20'} stroke={colors.purple} strokeWidth="2" rx="10" />
            <text x="300" y="70" textAnchor="middle" fill={colors.purple} fontSize="11" fontWeight="bold">Application Firewall</text>
            <text x="300" y="90" textAnchor="middle" fill={colors.purple} fontSize="28">üîç</text>
            <text x="300" y="115" textAnchor="middle" fill={colors.textDim} fontSize="9">Termina connessione</text>
            <text x="300" y="130" textAnchor="middle" fill={colors.textDim} fontSize="9">Ispeziona contenuto</text>
            <text x="300" y="145" textAnchor="middle" fill={colors.textDim} fontSize="9">Rigenera connessione</text>
            <rect x="480" y="70" width="80" height="60" fill={colors.bgLight} stroke={colors.success} strokeWidth="2" rx="8" />
            <text x="520" y="95" textAnchor="middle" fill={colors.success} fontSize="24">üñ•Ô∏è</text>
            <text x="520" y="120" textAnchor="middle" fill={colors.success} fontSize="10">Server</text>
            <line x1="120" y1="100" x2="215" y2="100" stroke={colors.info} strokeWidth="2" />
            <text x="168" y="90" textAnchor="middle" fill={colors.info} fontSize="9">Conn. 1</text>
            <line x1="385" y1="100" x2="475" y2="100" stroke={colors.success} strokeWidth="2" />
            <text x="430" y="90" textAnchor="middle" fill={colors.success} fontSize="9">Conn. 2</text>
            <text x="300" y="185" textAnchor="middle" fill={colors.textMuted} fontSize="10">Il proxy termina e rigenera due connessioni separate</text>
          </svg>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '20px' }}>
            <Box type="success" title="Vantaggi">
              <ul style={{ margin: 0, paddingLeft: '16px' }}>
                <li>Isola completamente client e server</li>
                <li>Nasconde la topologia interna</li>
                <li>Pu√≤ modificare/sanificare i dati</li>
                <li>Logging dettagliato a livello applicativo</li>
              </ul>
            </Box>
            <Box type="danger" title="Svantaggi">
              <ul style={{ margin: 0, paddingLeft: '16px' }}>
                <li>Latenza aggiuntiva</li>
                <li>Richiede proxy per ogni protocollo</li>
                <li>Problemi con protocolli non standard</li>
                <li>Pu√≤ rompere applicazioni end-to-end</li>
              </ul>
            </Box>
          </div>
        </div>
      ),

      // Slide 7: NGFW
      () => (
        <div style={{ padding: '30px' }}>
          <h2 style={{ color: colors.success, marginBottom: '24px', display: 'flex', alignItems: 'center', gap: '12px' }}>
            <span style={{ fontSize: '28px' }}>4Ô∏è‚É£</span> Next-Generation Firewall (NGFW)
          </h2>
          <Glow color={colors.success}>
            <h3 style={{ color: colors.success, marginBottom: '14px' }}>üöÄ Evoluzione Integrata</h3>
            <p style={{ color: colors.textDim, marginBottom: '16px', lineHeight: '1.6' }}>
              Combina <strong style={{ color: colors.text }}>TUTTE</strong> le funzionalit√† dei firewall precedenti
              in un unico dispositivo, aggiungendo threat intelligence e machine learning.
            </p>
            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(140px, 1fr))', gap: '12px' }}>
              {[
                ['üî•', 'Packet Filter', 'L3-L4 filtering'],
                ['üìä', 'Stateful', 'Connection tracking'],
                ['üîç', 'DPI', 'Deep Packet Inspection'],
                ['üõ°Ô∏è', 'IPS/IDS', 'Intrusion Prevention'],
                ['üîê', 'SSL Inspection', 'Decrypt & Inspect'],
                ['üë§', 'User Identity', 'Chi sta navigando'],
                ['üì±', 'App Control', 'Blocca Spotify, TikTok...'],
                ['üß†', 'Threat Intel', 'Feed di minacce'],
                ['üì¶', 'Sandboxing', 'Analisi file sospetti'],
              ].map(([icon, name, desc]) => (
                <div key={name} style={{ background: colors.bgLight, padding: '12px', borderRadius: '8px', textAlign: 'center' }}>
                  <div style={{ fontSize: '20px', marginBottom: '4px' }}>{icon}</div>
                  <div style={{ color: colors.text, fontSize: '12px', fontWeight: '500' }}>{name}</div>
                  <div style={{ color: colors.textMuted, fontSize: '10px' }}>{desc}</div>
                </div>
              ))}
            </div>
          </Glow>
          <Table headers={['Vendor', 'Prodotto', 'Punti di forza']} rows={[
            ['Palo Alto', 'PA Series', 'Leader mercato, App-ID eccellente'],
            ['Fortinet', 'FortiGate', 'Ottimo prezzo/prestazioni, ASIC dedicati'],
            ['Cisco', 'Firepower', 'Integrazione ecosistema Cisco'],
            ['Check Point', 'Quantum', 'Storico, ottima threat prevention'],
          ]} />
        </div>
      ),

      // Slide 8: Comparison
      () => (
        <div style={{ padding: '30px' }}>
          <h2 style={{ color: colors.accent, marginBottom: '24px' }}>üìä Confronto Tipologie</h2>
          <Table headers={['Caratteristica', 'Packet Filter', 'Stateful', 'Application', 'NGFW']} rows={[
            ['Livello OSI', 'L3-L4', 'L3-L4', 'L7', 'L3-L7'],
            ['Analisi Header', '‚úì', '‚úì', '‚úì', '‚úì'],
            ['Analisi Payload', '‚úó', '‚úó', '‚úì', '‚úì'],
            ['Tracking Connessioni', '‚úó', '‚úì', '‚úì', '‚úì'],
            ['Application Awareness', '‚úó', '‚úó', '‚úì (proxy)', '‚úì (nativo)'],
            ['IPS Integrato', '‚úó', '‚úó', '‚úó', '‚úì'],
            ['User Identity', '‚úó', '‚úó', '‚úó', '‚úì'],
            ['Performance', '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê', '‚≠ê‚≠ê‚≠ê‚≠ê', '‚≠ê‚≠ê', '‚≠ê‚≠ê‚≠ê'],
            ['Sicurezza', '‚≠ê‚≠ê', '‚≠ê‚≠ê‚≠ê', '‚≠ê‚≠ê‚≠ê‚≠ê', '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê'],
            ['Complessit√† Config', 'Bassa', 'Media', 'Alta', 'Alta'],
            ['Costo', '‚Ç¨', '‚Ç¨‚Ç¨', '‚Ç¨‚Ç¨‚Ç¨', '‚Ç¨‚Ç¨‚Ç¨‚Ç¨'],
          ]} />
          <Box type="tip" title="Come scegliere?">
            <strong>PMI:</strong> Stateful con antivirus √® spesso sufficiente |
            <strong> Enterprise:</strong> NGFW √® lo standard |
            <strong> Web server pubblici:</strong> Aggiungere WAF (Web Application Firewall)
          </Box>
        </div>
      ),

      // Slide 9: Packet Inspector Simulator
      () => (
        <div style={{ padding: '30px' }}>
          <h2 style={{ color: colors.accent, marginBottom: '24px' }}>üî¨ Simulatore: Packet Inspector</h2>
          <PacketInspector />
          <Box type="info" title="Cosa impari">
            Seleziona i diversi tipi di firewall per vedere quali informazioni del pacchetto riescono ad analizzare.
            Un NGFW vede molto pi√π di un semplice packet filter!
          </Box>
        </div>
      ),

      // Slide 10: Stateful Connection Tracker
      () => (
        <div style={{ padding: '30px' }}>
          <h2 style={{ color: colors.accent, marginBottom: '24px' }}>üîÑ Simulatore: Connection Tracker</h2>
          <StatefulConnectionTracker />
          <Box type="tip" title="Stateful Inspection">
            Un firewall stateful tiene traccia di tutte le connessioni attive. Questo permette di riconoscere
            pacchetti di risposta legittimi e bloccare pacchetti che non appartengono a connessioni valide.
          </Box>
        </div>
      ),
    ];

    function App() {
      const [current, setCurrent] = useState(0);
      const total = slides.length;
      const next = () => setCurrent(c => Math.min(c + 1, total - 1));
      const prev = () => setCurrent(c => Math.max(c - 1, 0));

      useEffect(() => {
        const handler = e => {
          if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); next(); }
          if (e.key === 'ArrowLeft') { e.preventDefault(); prev(); }
          if (e.key === 'Escape') window.location.href = 'index.html';
        };
        window.addEventListener('keydown', handler);
        return () => window.removeEventListener('keydown', handler);
      }, []);

      return (
        <div style={{ minHeight: '100vh', background: colors.bg }}>
          <div style={{ position: 'fixed', top: 0, left: 0, right: 0, height: '50px', background: colors.bgCard + 'e0', backdropFilter: 'blur(10px)', borderBottom: `1px solid ${colors.border}`, display: 'flex', alignItems: 'center', justifyContent: 'space-between', padding: '0 20px', zIndex: 100 }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
              <a href="index.html" style={{ color: colors.textMuted, textDecoration: 'none', fontSize: '13px' }}>‚Üê Indice</a>
              <span style={{ color: colors.border }}>|</span>
              <span style={{ color: colors.accent, fontWeight: '600' }}>Modulo 2</span>
              <span style={{ color: colors.textDim }}>Tipologie Firewall</span>
            </div>
            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
              <span style={{ color: colors.textMuted, fontSize: '13px' }}>{current + 1} / {total}</span>
              <div style={{ width: '100px', height: '4px', background: colors.bgLight, borderRadius: '2px' }}>
                <div style={{ height: '100%', width: `${((current + 1) / total) * 100}%`, background: colors.accent, borderRadius: '2px', transition: 'width 0.3s' }} />
              </div>
            </div>
          </div>
          <div style={{ paddingTop: '50px', paddingBottom: '70px', minHeight: 'calc(100vh - 120px)' }}>
            <div style={{ maxWidth: '1200px', margin: '0 auto', padding: '0 24px' }}>
              {slides[current]()}
            </div>
          </div>
          <div style={{ position: 'fixed', bottom: 0, left: 0, right: 0, height: '60px', background: colors.bgCard + 'e0', backdropFilter: 'blur(10px)', borderTop: `1px solid ${colors.border}`, display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '16px', zIndex: 100 }}>
            {current === 0 && <a href="modulo1-firewall-intro.html" style={{ padding: '10px 24px', background: colors.bgCard, border: `1px solid ${colors.border}`, borderRadius: '8px', color: colors.text, textDecoration: 'none', fontSize: '14px' }}>‚Üê Modulo 1</a>}
            {current > 0 && <button onClick={prev} style={{ padding: '10px 24px', background: colors.bgCard, border: `1px solid ${colors.border}`, borderRadius: '8px', color: colors.text, cursor: 'pointer', fontSize: '14px' }}>‚Üê Indietro</button>}
            <button onClick={next} disabled={current === total - 1} style={{ padding: '10px 24px', background: current === total - 1 ? colors.bgLight : `linear-gradient(135deg, ${colors.accent}, ${colors.accentAlt})`, border: 'none', borderRadius: '8px', color: current === total - 1 ? colors.textMuted : '#000', cursor: current === total - 1 ? 'not-allowed' : 'pointer', fontSize: '14px', fontWeight: '600' }}>Avanti ‚Üí</button>
            {current === total - 1 && <a href="modulo3-acl.html" style={{ padding: '10px 24px', background: `linear-gradient(135deg, ${colors.info}, #0284c7)`, border: 'none', borderRadius: '8px', color: '#fff', textDecoration: 'none', fontSize: '14px', fontWeight: '600' }}>Modulo 3 ‚Üí</a>}
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
